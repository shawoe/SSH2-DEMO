<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
    "http://struts.apache.org/dtds/struts-2.3.dtd">

<!-- struts为配置文件根元素-->
<struts>
    <!-- 设置浏览器是否缓存静态内容,默认值为true,开发阶段最好关闭 -->
    <constant name="struts.serve.static.browserCache" value="false" />
	<!-- 让struts2始终先考虑spring的自动装箱 -->
	<constant name="struts.objectFactory.spring.autoWire.alwaysRespect" value="true" />
	<!-- 开发模式下可以打印出更详细的错误信息 -->
	<constant name="struts.devMode" value="true" />
	<!-- 在Struts2的配置文件修改后自动加载 -->
	<constant name="struts.configuration.xml.reload" value="true" />
	<!-- 声明字符集解决乱码 -->
	<constant name="struts.i18n.encoding" value="gbk"></constant>
    <!-- 指定允许上传的文件最大字节数为10M,默认值是2097152(2M) -->
    <constant name="struts.multipart.maxSize" value="107010960"/>
    <!-- 设置上传文件的临时文件夹 -->
    <constant name="struts.multipart.saveDir " value="/upload" />
	<!-- Action必须放在指定的包名空间中-->
	<package name="struts2" extends="struts-default">
	
	
	<!-- Member.UserAction -->
		<action name="loginUser" class="member.UserAction" method="login">
			<!-- Stop double-submission of forms -->
			<interceptor-ref name="defaultStack"/>
        	<interceptor-ref name="token" />
        	<result name="invalid.token" type="redirect">/error/repeat.jsp</result>
			<result name="error" type="redirect">/error/error.jsp</result>
			<result name="none" type="dispatcher">/user/login.jsp</result>
			<result name="input" type="dispatcher">/user/login.jsp</result>
			<result name="success" type="redirect">/user/welcome.jsp</result>
		</action>
		<action name="logoutUser" class="member.UserAction" method="logout">
			<result name="error" type="redirect">/error/error.jsp</result>
			<result name="login" type="redirect">/index.jsp</result>
			<result name="none" type="redirect">/index.jsp</result>
			<result name="success" type="redirect">/index.jsp</result>
		</action>
		<action name="registerUser" class="member.UserAction" method="register">
			<!-- Stop double-submission of forms -->
			<interceptor-ref name="defaultStack"/>
        	<interceptor-ref name="token" />
        	<result name="invalid.token" type="redirect">/error/repeat.jsp</result>
			<result name="error" type="redirect">/error/error.jsp</result>
			<result name="input" type="dispatcher">/user/register.jsp</result>
			<result name="success" type="redirect">/user/login.jsp</result>
		</action>
		<action name="showAllUsers" class="member.UserAction" method="showAll">
			<result name="none" type="redirect">/user/show.jsp</result>
			<result name="success" type="dispatcher">/user/show.jsp</result>
		</action>
		<action name="showUser" class="member.UserAction" method="show">
			<result name="login" type="redirect">/user/login.jsp</result>
			<result name="success" type="dispatcher">/user/edit.jsp</result>
		</action>
		<action name="editUser" class="member.UserAction" method="edit">
			<!-- Stop double-submission of forms -->
			<interceptor-ref name="defaultStack"/>
        	<interceptor-ref name="token" />
        	<result name="invalid.token" type="redirect">/error/repeat.jsp</result>
			<result name="error" type="redirect">/error/error.jsp</result>
			<result name="login" type="redirect">/user/login.jsp</result>
			<result name="none" type="redirect">/user/login.jsp</result>
			<result name="input" type="dispatcher">/user/edit.jsp</result>
			<result name="success" type="redirectAction">user/showUser</result>
		</action>
		<action name="changeUserPassword" class="member.UserAction" method="changePassword">
			<!-- Stop double-submission of forms -->
			<interceptor-ref name="defaultStack"/>
        	<interceptor-ref name="token" />
        	<result name="invalid.token" type="redirect">/error/repeat.jsp</result>
			<result name="error" type="redirect">/error/error.jsp</result>
			<result name="login" type="redirect">/user/login.jsp</result>
			<result name="none" type="redirect">/user/login.jsp</result>
			<result name="input" type="dispatcher">/user/command.jsp</result>
			<result name="success" type="redirectAction">logoutUser</result>
		</action>
        <action name="uploadAvatar" class="member.UserAction" method="uploadAvatar">
			<!-- Stop double-submission of forms -->
			<interceptor-ref name="defaultStack"/>
        	<interceptor-ref name="token" />
        	<result name="invalid.token" type="redirect">/error/repeat.jsp</result>
			<result name="error" type="redirect">/error/error.jsp</result>
			<result name="login" type="redirect">/user/login.jsp</result>
            <result name="success" type="redirect">/user/welcome.jsp</result>
        </action>	
		
	<!-- Message.SMSAction -->
		<action name="readSMS" class="message.SMSAction" method="read">
			<result name="error" type="redirect">/sms/error.jsp</result>
			<result name="success" type="dispatcher">/sms/read.jsp</result>
		</action>
		<action name="readFirstSMS" class="message.SMSAction" method="readFirst">
			<result name="error" type="redirect">/sms/error.jsp</result>
			<result name="success" type="dispatcher">/sms/read.jsp</result>
		</action>
		<action name="readNextSMS" class="message.SMSAction" method="readNext">
			<result name="error" type="redirect">/sms/error.jsp</result>
			<result name="success" type="dispatcher">/sms/read.jsp</result>
		</action>
		<action name="readLastSMS" class="message.SMSAction" method="readLast">
			<result name="error" type="redirect">/sms/error.jsp</result>
			<result name="success" type="dispatcher">/sms/read.jsp</result>
		</action>
		<action name="readEndSMS" class="message.SMSAction" method="readEnd">
			<result name="error" type="redirect">/sms/error.jsp</result>
			<result name="success" type="dispatcher">/sms/read.jsp</result>
		</action>
		<action name="sendSMS" class="message.SMSAction" method="send">
			<!-- Stop double-submission of forms -->
			<interceptor-ref name="defaultStack"/>
        	<interceptor-ref name="token" />
        	<result name="invalid.token" type="redirect">/error/repeat.jsp</result>
			<result name="error" type="redirect">/error/error.jsp</result>
			<result name="login" type="redirect">/user/login.jsp</result>
			<result name="none" type="redirect">/user/login.jsp</result>
			<result name="input" type="dispatcher">/sms/write.jsp</result>
			<result name="success" type="redirectAction">sms/readFirstSMS</result>
		</action>
		
	<!-- Monitor.LoggerAction -->
		<action name="readLogger" class="monitor.LoggerAction" method="read">
			<result name="error" type="redirect">/logger/error.jsp</result>
			<result name="success" type="dispatcher">/logger/read.jsp</result>
		</action>
		<action name="readFirstLogger" class="monitor.LoggerAction" method="readFirst">
			<result name="error" type="redirect">/logger/error.jsp</result>
			<result name="success" type="dispatcher">/logger/read.jsp</result>
		</action>
		<action name="readNextLogger" class="monitor.LoggerAction" method="readNext">
			<result name="error" type="redirect">/logger/error.jsp</result>
			<result name="success" type="dispatcher">/logger/read.jsp</result>
		</action>
		<action name="readLastLogger" class="monitor.LoggerAction" method="readLast">
			<result name="error" type="redirect">/logger/error.jsp</result>
			<result name="success" type="dispatcher">/logger/read.jsp</result>
		</action>
		<action name="readEndLogger" class="monitor.LoggerAction" method="readEnd">
			<result name="error" type="redirect">/logger/error.jsp</result>
			<result name="success" type="dispatcher">/logger/read.jsp</result>
		</action>
		
	</package>
</struts>

